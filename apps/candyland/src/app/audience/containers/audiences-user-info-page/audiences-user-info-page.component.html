<section class="page-header">
  <h1 class="title">{{'AUDIENCE_FEATURE.AUDIENCES' | translate}}</h1>
  <cs-button
    classList="primary cs-btn-mobile"
    (click)="openEditUserDialog()">
    <i class="cs-btn-mobile-icon icon edit-icon"></i>
    {{'BTN_EDIT' | translate}}
  </cs-button>
</section>

<cl-audiences-user-info [user]="user"></cl-audiences-user-info>

<section class="content">
  <mat-tab-group>
    <mat-tab label="Vouchers">
      <div class="audience-list-content">
        <!--filters-->
        <cl-table-filters [dataSource]="vouchersDataSource" classList="block">
          <ng-container *clTableFilter="'rewardName'; let filter">
            <cl-search-filter class="search-block" [control]="filter"
                              [placeholder]="'AUDIENCE_FEATURE.SEARCH_VOUCHERS' | translate"></cl-search-filter>
            <cs-button classList="primary" (click)="openSelectRewardPopup()">
              <span>{{'AUDIENCE_FEATURE.ISSUE_VOUCHER' | translate}}</span>
            </cs-button>
          </ng-container>
        </cl-table-filters>

        <div class="table-card">
          <!--table-->
          <cl-audiences-vouchers-list [dataSource]="vouchersDataSource"
                                      (clickChangeExpiryDate)="openChangeExpiryDateDialog($event)">
          </cl-audiences-vouchers-list>
          <!--/table-->
          <!--paginator-->
          <cl-paginator [dataSource]="vouchersDataSource" [pageSize]="5" [pageSizeOptions]="[5, 10, 20]"></cl-paginator>
          <!--/paginator-->
        </div>
      </div>
    </mat-tab>
    <mat-tab label="Communications" class="audience-list-content">
      <div class="audience-list-content">
        <div class="send-message-container">
          <cs-button [classList]="'primary'" (click)="openSendMessagePopup()">
            <span>{{'AUDIENCE_FEATURE.SEND_MESSAGE' | translate}}</span>
          </cs-button>
        </div>
        <div class="table-card">
          <!--table-->
          <cl-audiences-communications-list [dataSource]="communicationsDataSource">
          </cl-audiences-communications-list>
          <!--/table-->
          <!--paginator-->
          <cl-paginator [dataSource]="communicationsDataSource" [pageSize]="5" [pageSizeOptions]="[5, 10, 20]">
          </cl-paginator>
          <!--/paginator-->
        </div>
      </div>
    </mat-tab>
    <mat-tab label="Loyalty" class="audience-list-content">
      <div class="audience-list-content">
        <div class="audience-list-loyalty-panel">
          <cs-button classList="primary" (click)="openAddLoyaltyPopup()">Add Loyalty</cs-button>
        </div>
        <!--table-->
        <div class="table-card" [ngSwitch]="loyaltyDataSource?.state$ | async">
          <ng-container *ngSwitchCase="dataSourceStates.hasDataApi">
            <cl-audiences-loyalty-grid [dataSource]="loyaltyDataSource" [menuOptions]="loyaltyMenuOptions"
                                       (menuTapped)="handleAudiencesUserInfoActions($event)">
            </cl-audiences-loyalty-grid>
            <!--/table-->
            <!--paginator-->
            <!--            <cl-paginator [dataSource]="dataSourceCommunications"-->
            <!--                          [pageSize]="5"-->
            <!--                          [pageSizeOptions]="[5, 10, 20]"></cl-paginator>-->
            <!--/paginator-->
          </ng-container>
          <cl-no-data *ngSwitchCase="dataSourceStates.noDataApi">
            <img class="no-data-img" src="/assets/images/no-data/loyalty-empty-illustration.svg" alt="">
            <h2 class="no-data-title">
              {{'LOYALTY_FEATURE.NO_DATA_TITLE' | translate}}
            </h2>
            <p class="no-data-text">
              {{'LOYALTY_FEATURE.NO_DATA_TEXT' | translate}}
            </p>
          </cl-no-data>
        </div>
      </div>
    </mat-tab>
  </mat-tab-group>

</section>
