<div class="content-container">
  <div class="main-container" [ngSwitch]="currentStep">
    <h1 class="forgot-title">{{'FORGET_PW_PAGE.TITLE' | translate}}</h1>

    <ng-container *ngSwitchCase="1">
      <p class="subheading">{{'FORGET_PW_PAGE.DESCRIPTION' | translate}}</p>

      <form [formGroup]="phoneStepForm" (submit)="phoneHandler()">
        <mat-form-field class="full-width__input" appearance="fill">
          <mat-label>Country Code</mat-label>
          <mat-select [compareWith]="compareCtryFn" formControlName="countryCode">
            <mat-option [value]="country" *ngFor="let country of countriesList$ | async">
              <ng-container translate>{{country.name}}</ng-container>(+{{country.code}})
            </mat-option>
          </mat-select>
          <mat-error *ngIf="countryCode?.errors?.required">
            {{'FORGET_PW_PAGE.COUNTRY_CODE_REQUIRED_TXT' | translate}}
          </mat-error>
        </mat-form-field>
        <mat-form-field appearance="fill" class="full-width__input">
          <mat-label>{{'FORGET_PW_PAGE.MOBILE_FIELD' | translate}}</mat-label>
          <input type="tel" matInput formControlName="phoneNumber">
          <mat-error *ngIf="phoneNumber?.errors?.required">
            {{'FORGET_PW_PAGE.MOBILE_REQURIED_TXT' | translate}}
          </mat-error>
          <mat-error *ngIf="phoneNumber?.errors?.pattern || phoneNumber?.errors?.minlength">
            {{'FORGET_PW_PAGE.MOBILE_INVALID_TXT' | translate}}
          </mat-error>
        </mat-form-field>

        <button mat-raised-button color="primary" class="full-width__button">
          {{'FORGET_PW_PAGE.CTA_NEXT_TXT' | translate}}
        </button>
      </form>

    </ng-container>

    <ng-container *ngSwitchCase="2">
      <p class="subheading">
        <ng-container>{{'FORGET_PW_PAGE.OTP_SEND_TO' | translate}}</ng-container> (******{{usersPhone}}) <ng-container>{{'FORGET_PW_PAGE.CHECK_YOUR_SMS' | translate}}
        </ng-container>
      </p>
      <perx-core-pin-input class="forgot-pin" [length]="6" (full)="handlePin($event)"></perx-core-pin-input>

      <button mat-stroked-button class="forgot-resend" (click)="resend()" translate>{{ 'FORGET_PW_PAGE.REDEND_OTP' | translate }}</button>
    </ng-container>

    <ng-container *ngSwitchCase="3">
      <form [formGroup]="newPasswordForm" (submit)="changePassword()">
        <mat-form-field appearance="fill" class="full-width__input">
          <mat-label>{{'FORGET_PW_PAGE.NEW_PW_TXT' | translate}}</mat-label>
          <input type="password" matInput formControlName="newPassword">
          <mat-error *ngIf="password?.errors?.required">
            {{"Required" | translate}}
          </mat-error>
          <mat-error *ngIf="password?.errors?.minlength">
            {{"Password is too short" | translate}}
          </mat-error>
        </mat-form-field>

        <mat-form-field appearance="fill" class="full-width__input">
          <mat-label>{{'FORGET_PW_PAGE.CONFIRM_PW_TXT' | translate}}</mat-label>
          <input type="password" matInput formControlName="passwordConfirmation">
          <mat-error *ngIf="passwordConfirmation?.errors?.required">
            {{"Required" | translate}}
          </mat-error>
          <mat-error *ngIf="passwordConfirmation?.errors?.minlength">
            {{"Password is too short" | translate}}
          </mat-error>
          <mat-error *ngIf="passwordConfirmation?.errors?.notEqual">
            {{"Password do not match" | translate}}
          </mat-error>
        </mat-form-field>

        <button mat-raised-button color="primary" class="full-width__button">{{'FORGET_PW_PAGE.CTA_SAVE_TXT' | translate}}</button>
      </form>
    </ng-container>
  </div>
</div>
